<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get Usrs data</title>
</head>
<body>
    <div class="demo">

    </div>
<script type="text/javascript">
    /*
      Q: Find the developers from around the world AND get the desgination which has isActive: true
      Our result should be something like
      Result: [ { country: "country name",  person_name:"name", currentJob: "designation "}]
      In simple words, We need to fetch the developers data with their current designation.
   */
let fetchUserData = "./developer-data.json"; // access Json data base form an extrenal file 
// This function will read the user object and get the results based on passed parameters
function findActiveDeveloper(countrysInfo, target) {
   let result = [] // create an empty array
   for (const country in countrysInfo) { // get all keys in the object
      let countryName = ``,developerName = ``, cruntJob = []; // store filtered data 
      for (let i = 0; i < countrysInfo[country].length; i++) { // get data from the nested array
         const eachCountryData = countrysInfo[country][i];
         if (eachCountryData.position === target) { // filter result based on the target parameter passed
            countryName = country // get country name
            developerName = eachCountryData.name // get developer name
            eachCountryData.jobs.filter(job => {
               if(job.isActive === true )
                  cruntJob.push(job.designation)
               })
            if (developerName && countryName && cruntJob.length > 0) {
               let developerDetails = {
                  "Person Name": developerName,
                  "Country Name": countryName,
                  "Current Job": cruntJob
               } // create an object based on filtered data
               result.push(developerDetails) // push the output object in an array
            }
         } 
         
      }
      
   }
   return console.log(result)
} 
fetch(fetchUserData)
   .then(response => response.json()) // Parse the response as JSON
   .then(userData => {
      /* function calling 
         the first parameter is an object of developer data 
         the secound parameter is position 
      */
      findActiveDeveloper(userData, "Developer")
   }) 
   .catch(error => console.error(error)); // Handle any errors 

    </script>

<script>
   /*
   Problem statement:
   Create a program that takes an array of objects representing 
   different students, each object containing 
   the student's name, age, and a list of their grades. 
   Your program should iterate over the array using a for-in loop, 
   calculate the average grade for each student, 
   and add a new property to the object called "averageGrade" with 
   the calculated value. Finally, the program should log 
   the updated array of objects to the console.
   */
   const studentsDetails = [
   { name: "Alice", age: 20, grades: [75, 80, 90] },
   { name: "Bob", age: 22, grades: [85, 70, 78] },
   { name: "Charlie", age: 21, grades: [90, 92, 88] }
   ];
   for (const student of studentsDetails) { // access users database
      let gradesSum = 0; // get sum of user grades
      for (const grade in student.grades) {
         gradesSum += student.grades[grade] // add each grade and get sum of all values
      }
      student.averageGrade = (gradesSum/student.grades.length).toFixed(2) // Add averageGrade key with value in each student database
   }
   console.log(studentsDetails)// Log student object array in the user console
 </script>
 <script>
   /*
   Problem statement:
      You have been provided with an array of objects that represent different employees of a company. 
      Each object contains the name, age, Arrya of departments, and salary of the employee. 
      Your task is to create a function that takes this array as input and returns a new array of objects with the following conditions:
      The employees should be sorted in ascending order of their ages.
      Only employees from the "Marketing" department should be included in the new array.
      The salary of each employee should be multiplied by 1.2.
DATA = [
   { "name": "John", "age": 28, "department": ["HR", "Marketing"], "salary": 50000 },
    { "name": "Mike", "age": 43, "department": ["IT","Marketing", "Dev"], "salary": 90000 },
    { "name": "Jane", "age": 35, "department": ["IT", "HR"], "salary": 80000 },
    { "name": "Bob", "age": 22, "department": ["IT", "Marketing"], "salary": 55000 }
 ]
*/
// Put sample data in .json file and fetch data from file using fetch with async functions and await , must use filter method and also try to use map method here.



try {
   const fetchUsers = async () => { // async keyword is used with 
   const response = await fetch("./employees-data.json");
   const allUsers = await response.json();
   return allUsers
}

async function getUserData() {
   let allUsersData = await fetchUsers();
   let departmentalRecord =  allUsersData.filter(employee => (employee.department.filter(department => department === 'Marketing')).join()) // filter form an array of object contaning any key which contains array 
       departmentalRecord = departmentalRecord.sort((empOne, empTwo) => empOne.age - empTwo.age ) // sort by age     
       departmentalRecord = departmentalRecord.map(employee => ({...employee, salary:employee.salary*1.2})) // increment 
    console.log(departmentalRecord)
}
getUserData()
} catch (error) {
   console.log(error)
}




 </script>
</body>
</html>